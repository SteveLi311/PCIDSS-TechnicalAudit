<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PCI DSS 4.0 - Requirement 5 Assessment Report</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: #fff;
            padding: 30px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 5px;
        }
        h1 {
            color: #333;
            border-bottom: 2px solid #2196F3;
            padding-bottom: 10px;
            margin-top: 0;
        }
        h2 {
            color: #2196F3;
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
            margin-top: 30px;
        }
        h3 {
            color: #555;
            margin-top: 20px;
        }
        .section {
            margin-bottom: 30px;
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow: hidden;
        }
        .section-header {
            background-color: #f0f0f0;
            padding: 10px 15px;
            cursor: pointer;
            position: relative;
        }
        .section-header:hover {
            background-color: #e0e0e0;
        }
        .section-header::after {
            content: "+";
            position: absolute;
            right: 15px;
            top: 10px;
            font-weight: bold;
        }
        .section-header.active::after {
            content: "-";
        }
        .section-content {
            padding: 15px;
            display: none;
        }
        .active + .section-content {
            display: block;
        }
        .check-item {
            border-left: 4px solid #ddd;
            padding: 10px;
            margin-bottom: 10px;
            background-color: #f9f9f9;
        }
        .pass {
            border-left-color: #4CAF50;
        }
        .fail {
            border-left-color: #f44336;
        }
        .warning {
            border-left-color: #ff9800;
        }
        .info-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        .info-table th, .info-table td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: left;
        }
        .info-table th {
            background-color: #f0f0f0;
        }
        .summary-box {
            margin-top: 20px;
            padding: 15px;
            background-color: #f0f0f0;
            border-radius: 5px;
        }
        .summary-table {
            width: 100%;
        }
        /* Detailed failure information styling */
        .detailed-info {
            margin-top: 15px;
        }
        details {
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 0.5em 0.5em 0;
            margin-bottom: 15px;
        }
        summary {
            font-weight: bold;
            margin: -0.5em -0.5em 0;
            padding: 0.5em;
            cursor: pointer;
            background-color: #f0f0f0;
        }
        details[open] {
            padding: 0.5em;
        }
        details[open] summary {
            border-bottom: 1px solid #ddd;
            margin-bottom: 0.5em;
        }
        .details-content {
            padding: 10px;
            background-color: #f9f9f9;
        }
        .summary-details {
            font-weight: bold;
            margin-bottom: 10px;
        }
        .recommendation {
            margin-top: 10px;
            padding: 10px;
            background-color: #f0f8ff;
            border-left: 3px solid #2196F3;
        }
            border-collapse: collapse;
            margin: 15px 0;
        }
        .summary-table th, .summary-table td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: left;
        }
        .summary-table th {
            background-color: #e0e0e0;
        }
        .progress-container {
            width: 100%;
            background-color: #ddd;
            border-radius: 5px;
            margin-top: 10px;
        }
        .progress-bar {
            height: 25px;
            border-radius: 5px;
            background-color: #4CAF50;
            text-align: center;
            line-height: 25px;
            color: white;
        }
        .recommendation {
            padding: 10px;
            margin-top: 10px;
            background-color: #e1f5fe;
            border-left: 4px solid #03a9f4;
        }
        .timestamp {
            color: #757575;
            font-style: italic;
            text-align: right;
        }
        pre {
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }
        code {
            font-family: Consolas, Monaco, 'Andale Mono', monospace;
            font-size: 0.9em;
        }
        /* Color classes */
        .green { color: #4CAF50; }
        .red { color: #f44336; }
        .yellow { color: #ff9800; }
        .blue { color: #2196F3; }
        .gray { color: #757575; }
        
        /* Print styling */
        @media print {
            body {
                background-color: white;
                padding: 0;
            }
            .container {
                box-shadow: none;
                padding: 0;
            }
            .section-content {
                display: block;
            }
            .section-header::after {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>PCI DSS 4.0 - Requirement 5 Compliance Assessment Report</h1>
        
        <div class="info-table">
            <table>
                <tr>
                    <th>AWS Account</th>
                    <td>094692261598</td>
                </tr>
                <tr>
                    <th>AWS Region</th>
                    <td>ap-southeast-1</td>
                </tr>
                <tr>
                    <th>Assessment Date</th>
                    <td>Wed Jun 25 08:00:43 UTC 2025</td>
                </tr>
                <tr>
                    <th>Assessed By</th>
                    <td>arn:aws:sts::094692261598:assumed-role/check-test/i-0830648e8ddd8522e</td>
                </tr>
            </table>
        </div>
        
        <div class="summary-box">
            <h2 style="margin-top: 0;">Summary</h2>
            <div id="summary-statistics">
                <!-- Placeholder - will be filled at the end -->
                <p>Assessment in progress...</p>
            </div>
        </div>
        
        <!-- Report content will be added here -->
        <div id="report-content">

        <div class="section">
            <div class="section-header active" onclick="this.classList.toggle('active'); this.nextElementSibling.style.display = this.classList.contains('active') ? 'block' : 'none';">
                AWS CLI Permissions Check
            </div>
            <div class="section-content" style="display: block;">
                <div id="permissions">
    

                    <div class="check-item pass">
                        <h3><span class="green">[PASS]</span> AWS API Access: ec2 describe-instances</h3>
                        <div><p>The AWS API command aws ec2 describe-instances executed successfully.</p></div>
    
                        <div class="recommendation">
                            <strong>Recommendation:</strong> AWS CLI permissions are sufficient for ec2:describe-instances.
                        </div>
        
                    </div>
    

                    <div class="check-item pass">
                        <h3><span class="green">[PASS]</span> AWS API Access: ssm describe-instance-information</h3>
                        <div><p>The AWS API command aws ssm describe-instance-information executed successfully.</p></div>
    
                        <div class="recommendation">
                            <strong>Recommendation:</strong> AWS CLI permissions are sufficient for ssm:describe-instance-information.
                        </div>
        
                    </div>
    

                    <div class="check-item pass">
                        <h3><span class="green">[PASS]</span> AWS API Access: guardduty list-detectors</h3>
                        <div><p>The AWS API command aws guardduty list-detectors executed successfully.</p></div>
    
                        <div class="recommendation">
                            <strong>Recommendation:</strong> AWS CLI permissions are sufficient for guardduty:list-detectors.
                        </div>
        
                    </div>
    

                    <div class="check-item pass">
                        <h3><span class="green">[PASS]</span> AWS API Access: inspector2 list-findings</h3>
                        <div><p>The AWS API command aws inspector2 list-findings executed successfully.</p></div>
    
                        <div class="recommendation">
                            <strong>Recommendation:</strong> AWS CLI permissions are sufficient for inspector2:list-findings.
                        </div>
        
                    </div>
    

                    <div class="check-item pass">
                        <h3><span class="green">[PASS]</span> AWS API Access: wafv2 list-web-acls</h3>
                        <div><p>The AWS API command aws wafv2 list-web-acls executed successfully.</p></div>
    
                        <div class="recommendation">
                            <strong>Recommendation:</strong> AWS CLI permissions are sufficient for wafv2:list-web-acls.
                        </div>
        
                    </div>
    

                    <div class="check-item pass">
                        <h3><span class="green">[PASS]</span> AWS API Access: configservice describe-config-rules</h3>
                        <div><p>The AWS API command aws configservice describe-config-rules executed successfully.</p></div>
    
                        <div class="recommendation">
                            <strong>Recommendation:</strong> AWS CLI permissions are sufficient for configservice:describe-config-rules.
                        </div>
        
                    </div>
    

                    <div class="check-item pass">
                        <h3><span class="green">[PASS]</span> AWS API Access: ssm list-inventory-entries</h3>
                        <div><p>The AWS API command aws ssm list-inventory-entries executed successfully.</p></div>
    
                        <div class="recommendation">
                            <strong>Recommendation:</strong> AWS CLI permissions are sufficient for ssm:list-inventory-entries.
                        </div>
        
                    </div>
    

                    <div class="check-item pass">
                        <h3><span class="green">[PASS]</span> AWS API Access: guardduty list-detectors</h3>
                        <div><p>The AWS API command aws guardduty list-detectors executed successfully.</p></div>
    
                        <div class="recommendation">
                            <strong>Recommendation:</strong> AWS CLI permissions are sufficient for guardduty:list-detectors.
                        </div>
        
                    </div>
    

                    <div class="check-item pass">
                        <h3><span class="green">[PASS]</span> AWS API Access: guardduty get-malware-protection-plan</h3>
                        <div><p>The AWS API command aws guardduty get-malware-protection-plan executed successfully.</p></div>
    
                        <div class="recommendation">
                            <strong>Recommendation:</strong> AWS CLI permissions are sufficient for guardduty:get-malware-protection-plan.
                        </div>
        
                    </div>
    

                    <div class="check-item pass">
                        <h3><span class="green">[PASS]</span> AWS API Access: ssm describe-patch-baselines</h3>
                        <div><p>The AWS API command aws ssm describe-patch-baselines executed successfully.</p></div>
    
                        <div class="recommendation">
                            <strong>Recommendation:</strong> AWS CLI permissions are sufficient for ssm:describe-patch-baselines.
                        </div>
        
                    </div>
    

                    <div class="check-item pass">
                        <h3><span class="green">[PASS]</span> AWS API Access: configservice describe-config-rules</h3>
                        <div><p>The AWS API command aws configservice describe-config-rules executed successfully.</p></div>
    
                        <div class="recommendation">
                            <strong>Recommendation:</strong> AWS CLI permissions are sufficient for configservice:describe-config-rules.
                        </div>
        
                    </div>
    

                    <div class="check-item pass">
                        <h3><span class="green">[PASS]</span> AWS API Access: events list-rules</h3>
                        <div><p>The AWS API command aws events list-rules executed successfully.</p></div>
    
                        <div class="recommendation">
                            <strong>Recommendation:</strong> AWS CLI permissions are sufficient for events:list-rules.
                        </div>
        
                    </div>
    

                    <div class="check-item pass">
                        <h3><span class="green">[PASS]</span> AWS API Access: guardduty get-detector</h3>
                        <div><p>The AWS API command aws guardduty get-detector executed successfully.</p></div>
    
                        <div class="recommendation">
                            <strong>Recommendation:</strong> AWS CLI permissions are sufficient for guardduty:get-detector.
                        </div>
        
                    </div>
    

                    <div class="check-item pass">
                        <h3><span class="green">[PASS]</span> AWS API Access: ssm list-commands</h3>
                        <div><p>The AWS API command aws ssm list-commands executed successfully.</p></div>
    
                        <div class="recommendation">
                            <strong>Recommendation:</strong> AWS CLI permissions are sufficient for ssm:list-commands.
                        </div>
        
                    </div>
    

                    <div class="check-item pass">
                        <h3><span class="green">[PASS]</span> AWS API Access: shield describe-subscription</h3>
                        <div><p>The AWS API command aws shield describe-subscription executed successfully.</p></div>
    
                        <div class="recommendation">
                            <strong>Recommendation:</strong> AWS CLI permissions are sufficient for shield:describe-subscription.
                        </div>
        
                    </div>
    

                    <div class="check-item pass">
                        <h3><span class="green">[PASS]</span> AWS API Access: shield list-protections</h3>
                        <div><p>The AWS API command aws shield list-protections executed successfully.</p></div>
    
                        <div class="recommendation">
                            <strong>Recommendation:</strong> AWS CLI permissions are sufficient for shield:list-protections.
                        </div>
        
                    </div>
    

                    <div class="check-item pass">
                        <h3><span class="green">[PASS]</span> AWS API Access: network-firewall list-firewalls</h3>
                        <div><p>The AWS API command aws network-firewall list-firewalls executed successfully.</p></div>
    
                        <div class="recommendation">
                            <strong>Recommendation:</strong> AWS CLI permissions are sufficient for network-firewall:list-firewalls.
                        </div>
        
                    </div>
    

                </div>
            </div>
        </div>
    

        <div class="section">
            <div class="section-header active" onclick="this.classList.toggle('active'); this.nextElementSibling.style.display = this.classList.contains('active') ? 'block' : 'none';">
                Requirement 5.2: Anti-malware mechanisms and processes to protect all systems against malware are defined and implemented
            </div>
            <div class="section-content" style="display: block;">
                <div id="req-5.2">
    

                    <div class="check-item fail">
                        <h3><span class="red">[FAIL]</span> 5.2.1 - Anti-malware protection deployment</h3>
                        <div>Checking access to AWS ssm describe-instance-information...
Checking access to AWS ssm list-inventory-entries...
Checking access to AWS guardduty list-detectors...
Checking access to AWS guardduty get-malware-protection-plan...
<p>Analysis of EC2 instances in region ap-southeast-1 for anti-malware protection:</p><ul><li class="red">Instance i-0da3583b888d44b66 (aws-ec2-prod-fim-01) - Platform: Linux/UNIX - No anti-malware tag found. Unable to determine if anti-malware is installed.</li><li class="red">Instance i-0cbd41e44508eac62 (aws-ec2-prod-gvm-01) - Platform: Linux/UNIX - No anti-malware tag found. Unable to determine if anti-malware is installed.</li><li class="red">Instance i-0963fb04f890084a2 (openvpn-for-portal-user (disabled)) - Platform: Linux/UNIX - No anti-malware tag found. Unable to determine if anti-malware is installed.</li><li class="red">Instance i-080847cc53b47de48 (aws-ec2-prod-jump-01) - Platform: windows - No anti-malware tag found. Unable to determine if anti-malware is installed.</li><li class="red">Instance i-0edd1bd69656c0291 (aws-ec2-test-win-01) - Platform: windows - No anti-malware tag found. Unable to determine if anti-malware is installed.</li><li class="red">Instance i-08717d827797dd6a5 (openvpn-for-portal-user-2) - Platform: Linux/UNIX - No anti-malware tag found. Unable to determine if anti-malware is installed.</li><li class="red">Instance i-01766dfdbb4d58782 (openvpn-for-portal-user-3) - Platform: Linux/UNIX - No anti-malware tag found. Unable to determine if anti-malware is installed.</li><li class="red">Instance i-03b3fb3510d5a7bbb (test) - Platform: Linux/UNIX - No anti-malware tag found. Unable to determine if anti-malware is installed.</li><li class="red">Instance i-0082ada0851a06fec (test-wp) - Platform: Linux/UNIX - No anti-malware tag found. Unable to determine if anti-malware is installed.</li><li class="red">Instance i-0830648e8ddd8522e (steve-test-01) - Platform: Linux/UNIX - No anti-malware tag found. Unable to determine if anti-malware is installed.</li></ul><p>Checking for SSM managed instances with anti-malware:</p><ul><li class="red">Instance i-080847cc53b47de48 (aws-ec2-prod-jump-01) - Platform: windows - No known anti-malware software found in SSM inventory.</li></ul><p>Checking for GuardDuty malware protection:</p><p class="red">GuardDuty Malware Protection plan not found for detector f4bdd236046b8bf4481e3c3961066b80 in region ap-southeast-1.</p></div>
    
                        <div class="recommendation">
                            <strong>Recommendation:</strong> Deploy anti-malware software on all systems commonly affected by malware, including servers, workstations, and other applicable systems.
                        </div>
        
                    </div>
    

                    <div class="check-item warning">
                        <h3><span class="yellow">[WARNING]</span> 5.2.2 - Periodic scans and active scanning</h3>
                        <div>Checking access to AWS events list-rules...
Checking access to AWS guardduty list-detectors...
Checking access to AWS guardduty get-detector...
Checking access to AWS ssm list-commands...
<p>Checking for evidence of periodic malware scans:</p><p class="yellow">No EventBridge rules found with 'Malware' in the name. Consider implementing scheduled malware scans.</p><p>Checking GuardDuty scan settings:</p><ul><li class="red">GuardDuty detector f4bdd236046b8bf4481e3c3961066b80 has malware protection or EBS scanning disabled.</li></ul><p class="yellow">No recent SSM commands found that appear to run malware scans. Verify if scans are being executed through other mechanisms.</p></div>
    
                        <div class="recommendation">
                            <strong>Recommendation:</strong> Ensure anti-malware mechanisms perform periodic scans and active or real-time scanning. Schedule automatic malware scans and configure real-time protection.
                        </div>
        
                    </div>
    

                    <div class="check-item warning">
                        <h3><span class="yellow">[WARNING]</span> 5.2.3 - Anti-malware mechanism updates</h3>
                        <div>Checking access to AWS ssm describe-patch-baselines...
Checking access to AWS configservice describe-config-rules...
Checking access to AWS inspector2 list-findings...
<p>Checking for anti-malware update mechanisms:</p><p class="green">Found the following patch baselines in SSM Patch Manager (review for anti-malware applicability):</p><ul><li>... (additional baselines not shown)</li></ul><p class="yellow">No patch groups found in SSM Patch Manager. Consider configuring patch groups for anti-malware updates.</p><p class="yellow">No maintenance windows found specifically for anti-malware updates. Consider creating dedicated maintenance windows.</p><p class="yellow">No AWS Config rules found that might enforce anti-malware requirements. Consider implementing rules for approved AMIs and required applications.</p><p class="green">No obvious malware or outdated software findings in Inspector results.</p></div>
    
                        <div class="recommendation">
                            <strong>Recommendation:</strong> Ensure anti-malware mechanisms are kept current. Implement automatic updates where possible or establish manual update processes with regular verification.
                        </div>
        
                    </div>
    

                </div>
            </div>
        </div>
    

        <div class="section">
            <div class="section-header active" onclick="this.classList.toggle('active'); this.nextElementSibling.style.display = this.classList.contains('active') ? 'block' : 'none';">
                Requirement 5.3: Anti-malware mechanisms and processes are active, maintained, and monitored
            </div>
            <div class="section-content" style="display: block;">
                <div id="req-5.3">
    

                    <div class="check-item warning">
                        <h3><span class="yellow">[WARNING]</span> 5.3.2 - Periodic scans and active scanning</h3>
                        <div>Checking access to AWS events list-rules...
Checking access to AWS guardduty list-detectors...
Checking access to AWS guardduty get-detector...
Checking access to AWS ssm list-commands...
<p>Checking for evidence of periodic malware scans:</p><p class="yellow">No EventBridge rules found with 'Malware' in the name. Consider implementing scheduled malware scans.</p><p>Checking GuardDuty scan settings:</p><ul><li class="red">GuardDuty detector f4bdd236046b8bf4481e3c3961066b80 has malware protection or EBS scanning disabled.</li></ul><p class="yellow">No recent SSM commands found that appear to run malware scans. Verify if scans are being executed through other mechanisms.</p></div>
    
                        <div class="recommendation">
                            <strong>Recommendation:</strong> Ensure anti-malware mechanisms perform periodic scans and active or real-time scanning OR perform continuous behavioral analysis of systems or processes. Schedule automatic malware scans and configure real-time protection.
                        </div>
        
                    </div>
    

                </div>
            </div>
        </div>
    

        <div class="section">
            <div class="section-header active" onclick="this.classList.toggle('active'); this.nextElementSibling.style.display = this.classList.contains('active') ? 'block' : 'none';">
                Requirement 5.4: Anti-phishing mechanisms protect users against phishing attacks
            </div>
            <div class="section-content" style="display: block;">
                <div id="req-5.4">
    

                    <div class="check-item info">
                        <h3><span class="blue">[INFO]</span> 5.4 - Boundary Protection</h3>
                        <div>Checking access to AWS wafv2 list-web-acls...
Checking access to AWS shield describe-subscription...
Checking access to AWS network-firewall list-firewalls...
<p>Checking for anti-malware mechanisms at CDE boundaries:</p><p>Found WAF Web ACLs in region ap-southeast-1:</p><ul></ul><p class="yellow">AWS Shield Advanced is not enabled. Consider enabling it for enhanced protection.</p><p class="yellow">No AWS Network Firewalls found in region ap-southeast-1. Network Firewalls can provide additional protection.</p></div>
    
                        <div class="recommendation">
                            <strong>Recommendation:</strong> Review boundary protections for potential anti-phishing capabilities in WAF, Shield, and Network Firewalls.
                        </div>
        
                    </div>
    

                </div>
            </div>
        </div>
    

        <div class="section">
            <div class="section-header active" onclick="this.classList.toggle('active'); this.nextElementSibling.style.display = this.classList.contains('active') ? 'block' : 'none';">
                Malware Protection at CDE Boundaries
            </div>
            <div class="section-content" style="display: block;">
                <div id="cde-boundaries">
    

                    <div class="check-item warning">
                        <h3><span class="yellow">[WARNING]</span> Malware Protection at CDE Boundaries</h3>
                        <div>Checking access to AWS wafv2 list-web-acls...
Checking access to AWS shield describe-subscription...
Checking access to AWS network-firewall list-firewalls...
<p>Checking for anti-malware mechanisms at CDE boundaries:</p><p>Found WAF Web ACLs in region ap-southeast-1:</p><ul></ul><p class="yellow">AWS Shield Advanced is not enabled. Consider enabling it for enhanced protection.</p><p class="yellow">No AWS Network Firewalls found in region ap-southeast-1. Network Firewalls can provide additional protection.</p></div>
    
                        <div class="recommendation">
                            <strong>Recommendation:</strong> Implement anti-malware mechanisms at system components that provide entry and exit points to/from the CDE, and at data transfer locations.
                        </div>
        
                    </div>
    

                </div>
            </div>
        </div>
    

        </div>
        
        <div class="timestamp">
            Report generated on: Wed Jun 25 08:01:58 UTC 2025
        </div>
        
        <script>
            // Replace the placeholder summary with the final statistics
            document.getElementById('summary-statistics').innerHTML = `
            <table class="summary-table">
                <tr>
                    <th>Total Checks</th>
                    <th>Passed</th>
                    <th>Failed</th>
                    <th>Warnings/Manual</th>
                    <th>Compliance</th>
                </tr>
                <tr>
                    <td>6</td>
                    <td><span class="green">0</span></td>
                    <td><span class="red">1</span></td>
                    <td><span class="yellow">4</span></td>
                    <td>0%</td>
                </tr>
            </table>
            
            <div class="progress-container">
                <div class="progress-bar" style="width: 0%; background-color: #f44336;">
                    0%
                </div>
            </div>
    `;
            
            // Add important notes at the end
            document.getElementById('report-content').innerHTML += `
            <h3>Important Notes</h3>
            <ol>
                <li>This report provides a high-level assessment of AWS controls for PCI DSS Requirement 5.</li>
                <li>Many checks require manual verification of documentation and procedures.</li>
                <li>A full PCI DSS assessment requires detailed analysis of all system components in the CDE.</li>
                <li>This report does not replace the need for a qualified security assessor (QSA).</li>
                <li>For a complete PCI DSS assessment, refer to the PCI DSS v4.0 standard.</li>
            </ol>
    `;
            
            // Automatically expand the first section
            document.addEventListener('DOMContentLoaded', function() {
                const firstHeader = document.querySelector('.section-header');
                if (firstHeader) {
                    firstHeader.classList.add('active');
                    firstHeader.nextElementSibling.style.display = 'block';
                }
            });
        </script>
    </div>
</body>
</html>

